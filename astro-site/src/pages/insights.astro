---
import BaseLayout from '../layouts/BaseLayout.astro';
import SecondaryHero from '../components/SecondaryHero.astro';
import FeaturedInsightSection from '../components/FeaturedInsightSection.astro';
import InsightsGridSection from '../components/InsightsGridSection.astro';

const title = "Industry Insights - Bixing Technology";
const description = "Stay updated with the latest insights, trends, and developments in AI technology. Explore our collection of articles and resources.";
---

<BaseLayout title={title} description={description}>
	<main>
		<SecondaryHero 
			title="Industry Insights" 
			subtitle="Explore the latest developments, strategies, and applications in AI"
			dataI18nTitle="insights.hero.title"
			dataI18nSubtitle="insights.hero.subtitle"
		/>
		
		<FeaturedInsightSection />
		<InsightsGridSection />

		<!-- Newsletter/Subscribe Section -->
		<section class="newsletter-section">
			<div class="container mx-auto px-4">
				<div class="newsletter-content max-w-4xl mx-auto text-center animate-fade-up">
					<h2 class="section-title text-3xl font-bold text-white mb-4" data-i18n="insights.newsletter.title">Stay Updated with AI Trends</h2>
					<p class="section-subtitle text-xl text-gray-400 mb-8" data-i18n="insights.newsletter.subtitle">Subscribe to our newsletter to receive the latest insights, articles, and updates in the world of AI</p>
					
					<div class="newsletter-form max-w-md mx-auto">
						<div class="input-group flex gap-4">
							<input type="email" class="newsletter-input flex-1 px-4 py-3 rounded-lg text-white focus:outline-none transition-colors" placeholder="Your Email Address" aria-label="Your Email Address" data-i18n-placeholder="insights.newsletter.emailPlaceholder">
							<button class="newsletter-button px-8 py-3 text-white font-semibold rounded-lg hover:shadow-lg transition-all duration-300" type="button" data-i18n="insights.newsletter.subscribe">Subscribe</button>
						</div>
						<div class="form-text text-white/50 mt-2 text-sm" data-i18n="insights.newsletter.privacyNotice">We respect your privacy. Unsubscribe at any time.</div>
					</div>
				</div>
			</div>
		</section>
	</main>
</BaseLayout>

<script>
    console.log('Insights page loaded');

    // IMMEDIATELY disable global i18n system before anything else
    window.applyTranslations = function() { return; };
    window.translations = { en: {}, zh: {} };

    // Isolated Insights page translations to prevent corruption
    const insightsTranslations = {
        en: {
            // Hero section
            'insights.hero.title': 'AI Industry Insights',
            'insights.hero.subtitle': 'Explore the latest developments, strategies, and applications in AI',

            // Featured insight
            'insights.featured.badge': 'Featured Insight',
            'insights.featured.title': '2025 Outlook: The Future of AI in Enterprise',
            'insights.featured.excerpt': 'As AI rapidly evolves, enterprises face new opportunities and challenges in implementation. Discover the key trends shaping the next year of AI adoption.',
            'insights.featured.link': 'Read Full Article',

            // Latest insights
            'insights.latest.title': 'Latest Insights',
            'insights.filter.all': 'All Topics',

            // Newsletter section
            'insights.newsletter.title': 'Stay Updated with AI Trends',
            'insights.newsletter.subtitle': 'Subscribe to our newsletter to receive the latest insights, articles, and updates in the world of AI',
            'insights.newsletter.emailPlaceholder': 'Your Email Address',
            'insights.newsletter.subscribe': 'Subscribe',
            'insights.newsletter.privacyNotice': 'We respect your privacy. Unsubscribe at any time.'
        },
        zh: {
            // Hero section
            'insights.hero.title': 'AI行业洞察',
            'insights.hero.subtitle': '探索AI的最新发展、策略和应用',

            // Featured insight
            'insights.featured.badge': '精选洞察',
            'insights.featured.title': '2025展望：企业AI的未来',
            'insights.featured.excerpt': '随着AI的快速发展，企业面临着新的机遇和挑战。发现塑造下一年AI采用的关键趋势。',
            'insights.featured.link': '阅读全文',

            // Latest insights
            'insights.latest.title': '最新洞察',
            'insights.filter.all': '所有主题',

            // Newsletter section
            'insights.newsletter.title': '保持AI趋势更新',
            'insights.newsletter.subtitle': '订阅我们的通讯，接收AI世界的最新洞察、文章和更新',
            'insights.newsletter.emailPlaceholder': '您的电子邮件地址',
            'insights.newsletter.subscribe': '订阅',
            'insights.newsletter.privacyNotice': '我们尊重您的隐私。随时可以退订。'
        }
    };

    // Force correct translations for Insights page
    function forceInsightsTranslations() {
        const currentLang = localStorage.getItem('bixingLanguage') || 'en';

        if (insightsTranslations[currentLang]) {
            // Apply translations to all insights page elements
            Object.keys(insightsTranslations[currentLang]).forEach(key => {
                const elements = document.querySelectorAll(`[data-i18n="${key}"]`);
                elements.forEach(element => {
                    element.textContent = insightsTranslations[currentLang][key];
                });
            });
        }
    }

    // Apply immediately and repeatedly
    setTimeout(forceInsightsTranslations, 1);
    setTimeout(forceInsightsTranslations, 10);
    setTimeout(forceInsightsTranslations, 25);
    setTimeout(forceInsightsTranslations, 50);
    setTimeout(forceInsightsTranslations, 100);

    document.addEventListener('DOMContentLoaded', function() {
        console.log('Insights page loaded');
        forceInsightsTranslations();
        setTimeout(forceInsightsTranslations, 50);
        setTimeout(forceInsightsTranslations, 100);
        setTimeout(forceInsightsTranslations, 200);
        setTimeout(forceInsightsTranslations, 500);
        setTimeout(forceInsightsTranslations, 1000);
    });

    // Keep applying correct translations periodically
    setInterval(forceInsightsTranslations, 2000);

    // Set up a MutationObserver to watch for text corruption and fix it immediately
    const observer = new MutationObserver(function(mutations) {
        let needsFix = false;
        mutations.forEach(function(mutation) {
            if (mutation.type === 'characterData' || mutation.type === 'childList') {
                const target = mutation.target;
                const text = target.textContent || '';
                if (text.includes('comprehen ive') || text.includes('Cu tom') || text.includes('Enterpri e')) {
                    needsFix = true;
                }
            }
        });

        if (needsFix) {
            console.log('Detected corrupted text, applying Insights page fixes...');
            forceInsightsTranslations();
        }
    });

    // Start observing the document body for changes
    observer.observe(document.body, {
        childList: true,
        subtree: true,
        characterData: true
    });

    // Listen for language toggle events
    document.addEventListener('languageToggled', function(e) {
        console.log('Language toggled event received - applying Insights page translations');
        forceInsightsTranslations();
    });

    // Also listen for storage events
    window.addEventListener('storage', function(e) {
        if (e.key === 'bixingLanguage') {
            console.log('Language storage event received - applying Insights page translations');
            forceInsightsTranslations();
        }
    });
</script>

<style>
	:root {
		--dark-surface: #1e1e1e;
		--dark-bg: #121212;
		--darker-bg: #0a1020;
		--primary-color: #0066FF;
		--accent-color: #00C2FF;
	}
	
	.newsletter-section {
		background: linear-gradient(135deg, var(--dark-bg), var(--darker-bg));
		padding: 60px 0;
		position: relative;
		overflow: hidden;
	}
	
	.newsletter-section::before {
		content: '';
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		background-image: url('/assets/images/circuit-pattern.svg');
		background-size: cover;
		opacity: 0.1;
		z-index: 1;
	}
	
	.newsletter-content {
		position: relative;
		z-index: 2;
	}
	
	.newsletter-form {
		max-width: 500px;
		margin: 30px auto 0;
	}
	
	.input-group {
		display: flex;
		gap: 1rem;
	}
	
	.newsletter-input {
		background: rgba(255, 255, 255, 0.1);
		border: 1px solid rgba(255, 255, 255, 0.2);
		color: white;
		border-radius: 30px;
		padding: 12px 25px;
		height: auto;
	}
	
	.newsletter-input:focus {
		background: rgba(255, 255, 255, 0.15);
		border-color: var(--primary-color);
		color: white;
		box-shadow: none;
		outline: none;
	}
	
	.newsletter-button {
		background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
		border: none;
		border-radius: 30px;
		padding: 12px 30px;
		font-weight: 500;
		transition: all 0.3s ease;
		cursor: pointer;
	}
	
	.newsletter-button:hover {
		transform: translateY(-3px);
		box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
	}
	
	.form-text {
		color: rgba(255, 255, 255, 0.5);
		margin-top: 0.5rem;
		font-size: 0.875rem;
	}
	
	.section-title {
		position: relative;
		display: inline-block;
	}
	
	.section-subtitle {
		color: rgba(255, 255, 255, 0.7);
	}
	
	.text-center {
		text-align: center;
	}
	
	.max-w-md {
		max-width: 28rem;
	}
	
	.max-w-4xl {
		max-width: 56rem;
	}
	
	.mx-auto {
		margin-left: auto;
		margin-right: auto;
	}
	
	.mb-4 {
		margin-bottom: 1rem;
	}
	
	.mb-8 {
		margin-bottom: 2rem;
	}
	
	.mt-2 {
		margin-top: 0.5rem;
	}
	
	.flex {
		display: flex;
	}
	
	.gap-4 {
		gap: 1rem;
	}
	
	.flex-1 {
		flex: 1 1 0%;
	}
</style>

